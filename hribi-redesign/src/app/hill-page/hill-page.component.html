<div class="hill-page-container" *ngIf="hillData">
  <header class="page-placeholder">
    <h1 class="hill-name">ğŸ”ï¸ {{ hillData.name }}</h1>
    <p
      style="color: rgba(255,255,255,0.95); text-align: center; font-size: 1.3rem; font-weight: 600; margin-top: 5px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
      ID: {{ hillData.id }}
    </p>
  </header>

  <div class="container-premium"
    style="max-width: 1400px; margin: -40px auto 60px; padding: 0 20px; position: relative; z-index: 10;">

    <!-- Top Section: Info + Weather + Gallery -->
    <div class="top-section">
      <!-- Basic Info -->
      <div class="basic-info-card card-panel group-card">
        <h2>Osnovni podatki</h2>
        <div class="info-table">
          <div class="info-row">
            <div class="info-label">ğŸŒ DrÅ¾ava:</div>
            <div class="info-value">{{ hillData.country }}</div>
          </div>
          <div class="info-row">
            <div class="info-label">â›°ï¸ Gorovje:</div>
            <div class="info-value">{{ hillData.mountainRange }}</div>
          </div>
          <div class="info-row">
            <div class="info-label">ğŸ“ ViÅ¡ina:</div>
            <div class="info-value">{{ hillData.height }} m</div>
          </div>
          <div class="info-row">
            <div class="info-label">ğŸ“ Koordinate:</div>
            <div class="info-value">
              {{ hillData.lat }}Â°N / {{ hillData.lon }}Â°E
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">ğŸ·ï¸ Vrsta:</div>
            <div class="info-value">{{ hillData.type }}</div>
          </div>
          <div class="info-row">
            <div class="info-label">â­ Priljubljenost:</div>
            <div class="info-value">
              <span *ngFor="let active of getPopularityIcons(hillData.popularity)" class="star-icon"
                [class.active]="active">â­</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Weather -->
      <div class="weather-card card-panel group-card">
        <div class="current-weather" *ngIf="currentWeather">
          <div class="current-weather-icon">
            {{ getWeatherEmoji(currentWeather.icon) }}
          </div>
          <div class="current-weather-info">
            <div class="current-temp">{{ currentWeather.temp }}Â°C</div>
            <div class="current-condition">
              {{ currentWeather.description | titlecase }}
            </div>
          </div>
        </div>

        <div class="weather-forecast">
          <h3>Napoved za naslednje dni</h3>
          <div class="forecast-days">
            <div class="forecast-day" *ngFor="let forecast of weatherForecast">
              <div class="day-name">{{ forecast.day }}</div>
              <div class="weather-icon">{{ getWeatherEmoji(forecast.icon) }}</div>
              <div class="temp">
                {{ forecast.highTemp }}Â°C / {{ forecast.lowTemp }}Â°C
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Gallery -->
    <div class="gallery-card card-panel group-card">
      <h2>Galerija ({{ hillData.images.length }})</h2>
      <div *ngIf="hillData.images.length === 0" class="gallery-placeholder">
        No images available.
      </div>
      <div class="thumbnail-row" *ngIf="hillData.images.length > 0">
        <div class="thumb" *ngFor="let img of hillData.images | slice:0:3" [title]="img.name"
          [style.backgroundImage]="'url(' + img.url + ')'" (click)="openImageModal(img)"></div>
      </div>
    </div>

    <!-- Description -->
    <div class="card-panel group-card">
      <h2>Opis</h2>
      <p class="description-text">{{ hillData.description }}</p>
    </div>

    <!-- Map and Routes Section -->
    <div class="map-routes-section">
      <!-- Map -->
      <div id="map-section" class="map-card card-panel group-card">
        <h2>ğŸ—ºï¸ Zemljevid</h2>
        <div id="hill-page-map" style="height: 400px; width: 100%; border-radius: 10px; z-index: 1;"></div>
        <div class="map-actions" style="margin-top: 15px; text-align: center;">
          <button class="map-button" (click)="openInGoogleMaps()">
            Odpri v Google Maps
          </button>
        </div>
      </div>

      <!-- Routes -->
      <div class="routes-card card-panel group-card">
        <h2>Poti ({{ hillData.routes.length }})</h2>
        <div *ngIf="hillData.routes.length === 0" class="no-routes-message">
          Ni navedenih poti.
        </div>
        <div class="routes-list">
          <div *ngFor="let route of hillData.routes; let i = index" class="route-item"
            [class.selected]="selectedRouteIndex === i" (click)="selectRoute(i)">
            <div class="route-summary">
              <h3>{{ route.name }}</h3>
              <div class="route-quick-info">
                <span class="route-time">â±ï¸ {{ route.time }}</span>
                <span class="route-difficulty">
                  <span *ngFor="let active of getDifficultyIcons(route.difficulty)" class="hiker-icon"
                    [class.active]="active">ğŸ¥¾</span>
                </span>
                <span class="route-height">ğŸ“ {{ route.heightDiff }}m</span>
              </div>
            </div>
            <div class="route-indicator">
              <span class="route-number">{{ i + 1 }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Route Details (Expanded when a route is selected) -->
    <div id="route-details" class="route-details-section group-card"
      *ngIf="selectedRouteIndex !== null && hillData.routes[selectedRouteIndex]">
      <h2>ğŸ“‹ Podrobnosti poti: {{ hillData.routes[selectedRouteIndex].name }}</h2>
      <div class="route-details-content">
        <div class="route-basic-info">
          <h3>Osnovni podatki</h3>
          <p><strong>ZaÄetek:</strong> {{ hillData.routes[selectedRouteIndex].start }}</p>
          <p><strong>Konec:</strong> {{ hillData.routes[selectedRouteIndex].end }}</p>
          <p><strong>ÄŒas hoje:</strong> {{ hillData.routes[selectedRouteIndex].time }}</p>
          <p><strong>ViÅ¡inska razlika:</strong> {{ hillData.routes[selectedRouteIndex].heightDiff }}m</p>
          <p><strong>TeÅ¾avnost:</strong>
            <span class="route-difficulty inline">
              <span *ngFor="let active of getDifficultyIcons(hillData.routes[selectedRouteIndex].difficulty)"
                class="hiker-icon" [class.active]="active">ğŸ¥¾</span>
            </span>
          </p>
          <p><strong>Poletna oprema:</strong> {{ hillData.routes[selectedRouteIndex].summerGear }}</p>
          <p><strong>Zimska oprema:</strong> {{ hillData.routes[selectedRouteIndex].winterGear }}</p>
          <p *ngIf="hillData.routes[selectedRouteIndex].gps" class="gpx-download-row">
            <strong>GPX sled:</strong>
            <button class="gpx-download-btn" (click)="downloadRouteGPX(hillData.routes[selectedRouteIndex].gps)">
              <span>ğŸ“¥</span> Prenesi GPX sled
            </button>
          </p>
        </div>

        <div class="route-description">
          <h3>Opisi</h3>
          <h4>Opis zaÄetka</h4>
          <p>{{ hillData.routes[selectedRouteIndex].descriptionOfStart }}</p>
          <h4>Opis poti</h4>
          <p>{{ hillData.routes[selectedRouteIndex].descriptionOfPath }}</p>
        </div>

        <div class="route-comments" *ngIf="hillData.routes[selectedRouteIndex].comments.length > 0">
          <h3>Komentarji ({{ hillData.routes[selectedRouteIndex].comments.length }})</h3>
          <div class="comment-item" *ngFor="let comment of hillData.routes[selectedRouteIndex].comments">
            <p>
              <strong>{{ comment.user }}</strong> - {{ comment.time | date }}:
              {{ comment.text }}
            </p>
          </div>
        </div>
      </div>

      <button class="close-details-btn" (click)="deselectRoute()">
        Zapri podrobnosti
      </button>
    </div>

    <!-- Webcams -->
    <div class="card-panel group-card">
      <h2>Spletne kamere ({{ hillData.webcams.length }})</h2>
      <div *ngIf="hillData.webcams.length === 0" class="no-comments">
        Ni spletnih kamer.
      </div>
      <div class="webcam-grid" *ngIf="hillData.webcams.length > 0">
        <div class="webcam-item" *ngFor="let webcam of hillData.webcams" (click)="openWebcam(webcam.url)"
          title="Odpri v novem zavihku">
          <div class="webcam-image-container">
            <img [src]="getLiveSrc(webcam)" [alt]="webcam.name" loading="lazy">
          </div>
          <div class="webcam-info">
            <strong>{{ webcam.name }}</strong>
          </div>
        </div>
      </div>
    </div>

    <!-- Comments -->
    <div class="card-panel group-card">
      <h2>Komentarji hriba ({{ hillData.comments.length }})</h2>
      <div *ngIf="hillData.comments.length === 0" class="no-comments">
        Ni komentarjev za ta hrib.
      </div>
      <div class="comment-item" *ngFor="let comment of hillData.comments">
        <p>
          <strong>{{ comment.user }}</strong> {{ comment.time | date }}:
          {{ comment.text }}
        </p>
      </div>
    </div>

    <div class="image-modal-overlay" *ngIf="selectedImage" (click)="closeImageModal()">
      <div class="modal-content">
        <img [src]="selectedImage.url" [alt]="selectedImage.alt">
        <div class="modal-caption">{{ selectedImage.name }}</div>
        <button class="close-modal-btn" (click)="closeImageModal()">âœ•</button>
      </div>
    </div>
  </div>

  <div *ngIf="!hillData">
    <h1>Error 404: Hill Not Found</h1>
    <p>Could not find a hill with ID: {{ hillID }}</p>
  </div>